---
title: Часть 1. Общие сведения о платформе Xamarin Mobile
description: В этом документе описывается платформа Xamarin на высоком уровне, анализ процесса компиляции, доступ к пакету SDK для платформы, совместное использование кода, создание пользовательского интерфейса, визуальные конструкторы и многое другое.
ms.prod: xamarin
ms.assetid: FBCEF258-D3D8-A420-79ED-3AAB4A7308E4
author: conceptdev
ms.author: crdun
ms.date: 03/23/2017
ms.openlocfilehash: 5398d99a64e7f6b75c8b9e418da252852aff1322
ms.sourcegitcommit: 933de144d1fbe7d412e49b743839cae4bfcac439
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/04/2019
ms.locfileid: "70288681"
---
# <a name="part-1--understanding-the-xamarin-mobile-platform"></a>Часть 1. Общие сведения о платформе Xamarin Mobile

Платформа Xamarin состоит из нескольких элементов, позволяющих разрабатывать приложения для iOS и Android:

- язык — позволяет использовать знакомый синтаксис и сложные функции, такие как универсальные шаблоны, LINQ и библиотека параллельных задач. **C#**
- **Mono .NET Framework** — предоставляет кросс-платформенную реализацию расширенных функций платформы Microsoft .NET Framework.
- **Компилятор** — в зависимости от платформы создает собственное приложение (например, iOS) или интегрированного приложения .NET и среды выполнения (например, Android). Компилятор также выполняет много операций оптимизации для развертывания мобильных устройств, таких как связывание неиспользуемого кода.
- **Средства IDE** — Visual Studio на Mac и Windows позволяет создавать, строить и развертывать проекты Xamarin.

Кроме того, поскольку базовый язык работает C# в .NET Framework, проекты могут быть структурированы для совместного использования кода, который также можно развернуть в Windows Phone.

## <a name="under-the-hood"></a>Внутри

Хотя Xamarin позволяет создавать приложения в C#и совместно использовать один и тот же код на нескольких платформах, фактическая реализация в каждой системе сильно различается.

## <a name="compilation"></a>Компиляция

C# Источник делает свой собственный код в собственном приложении очень разными способами на каждой платформе:

- **iOS** — C# это предварительное время (AOT), скомпилированное в язык ассемблера ARM. Платформа .NET Framework включается, при этом неиспользуемые классы удаляются во время компоновки, чтобы уменьшить размер приложения. Apple не разрешает создание кода во время выполнения в iOS, поэтому некоторые языковые функции недоступны (см. раздел [ограничения Xamarin. iOS](~/ios/internals/limitations.md) ).
- **Android** — C# компилируется в Il и упаковывается с помощью моновм + жит'инг. Неиспользуемые классы в платформе удаляются во время компоновки. Приложение работает параллельно с Java/ART (среда выполнения Android) и взаимодействует с собственными типами через JNI (см. раздел [ограничения Xamarin. Android](~/android/internals/limitations.md) ).
- **Windows** — C# компилируется в Il и выполняется во встроенной среде выполнения и не требует инструментов Xamarin. Разработка приложений Windows в соответствии с рекомендациями Xamarin упрощает повторное использование кода в iOS и Android.
  Обратите внимание, что универсальная платформа Windows также имеет параметр **.NET Native** , который ведет себя аналогично компиляции Xamarin. iOS в AOT.


Документация по компоновщику для [Xamarin. iOS](~/ios/deploy-test/linker.md) и [Xamarin. Android](~/android/deploy-test/linker.md) предоставляет дополнительные сведения об этой части процесса компиляции.

В среде выполнения "компиляция" динамически создается код `System.Reflection.Emit` с помощью — следует избегать.

Ядро Apple предотвращает динамическое создание кода на устройствах iOS, поэтому порожденный код не будет работать в Xamarin. iOS. Аналогичным образом функции среды выполнения динамического языка нельзя использовать с инструментами Xamarin.

Некоторые функции отражения работают (например, Однокасание. диалоговое окно использует его для API отражения), но не для создания кода.

## <a name="platform-sdk-access"></a>Доступ к пакету SDK для платформы

Xamarin делает функции, предоставляемые пакетом SDK для конкретной платформы, легко доступными C# с помощью привычного синтаксиса:

- **iOS** — Xamarin. iOS предоставляет платформы пакета SDK Кокоатауч для Apple как пространства имен, на которые можно ссылаться C#. Например, платформа UIKit, содержащая все элементы управления пользовательского интерфейса, может быть включена в простую `using UIKit;` инструкцию.
- **Android** — Xamarin. Android предоставляет пакет SDK для Android Google как пространства имен, поэтому вы можете ссылаться на любую часть поддерживаемого пакета SDK с помощью оператора using, например `using Android.Views;` для доступа к элементам управления пользовательского интерфейса.
- **Windows** — приложения Windows создаются с помощью Visual Studio в Windows. К типам проектов относятся Windows Forms, WPF, WinRT и универсальная платформа Windows (UWP).

## <a name="seamless-integration-for-developers"></a>Простая интеграция для разработчиков

Прелесть Xamarin заключается в том, что несмотря на различия внутри, Xamarin. iOS и Xamarin. Android (в сочетании с пакетами Microsoft Windows SDK) предлагают простой интерфейс для написания C# кода, который можно использовать повторно на всех трех платформах.

Бизнес-логика, использование базы данных, доступ к сети и другие общие функции можно записать один раз и повторно использовать на каждой платформе, предоставляя основу для пользовательских интерфейсов для конкретных платформ, которые выглядят и выполняются в качестве собственных приложений.

## <a name="integrated-development-environment-ide-availability"></a>Доступность интегрированной среды разработки (IDE)

Разработку Xamarin можно выполнять в Visual Studio на компьютерах Mac или Windows. Выбранная интегрированная среда разработки будет определяться платформами, для которых вы хотите ориентироваться.

Так как приложения Windows можно разрабатывать только в Windows, для сборки для iOS, Android _и_ Windows требуется Visual Studio для Windows. Однако существует возможность совместного использования проектов и файлов между компьютерами Windows и Mac, поэтому приложения iOS и Android могут быть построены на Mac, а общий код впоследствии может быть добавлен в проект Windows.

Требования к разработке для каждой платформы подробно описаны [в этом разделе](~/cross-platform/get-started/requirements.md) .

### <a name="ios"></a>iOS

Для разработки приложений iOS требуется компьютер Mac, на котором работает macOS. Visual Studio также можно использовать для создания и развертывания приложений iOS с помощью Xamarin в Visual Studio. Однако для целей сборки и лицензирования все еще требуется компьютер Mac.

Необходимо установить интегрированную среду разработки Apple Xcode, чтобы предоставить компилятор и симулятор для тестирования. Вы можете тестировать свои устройства [бесплатно](~/ios/get-started/installation/device-provisioning/free-provisioning.md), но для создания приложений для распространения (например, App Store), необходимо присоединиться к программе для разработчиков Apple ($99 долларов США в год). Каждый раз, когда вы отправляете или обновляете приложение, оно должно быть проверено и утверждено компанией Apple, прежде чем оно станет доступно для загрузки клиентами.

Код пишется с помощью интегрированной среды разработки Visual Studio и макетов экрана. их можно создавать программно или редактировать с помощью конструктора iOS в любой интегрированной среде разработки.

Подробные инструкции по настройке см. в [руководстве по установке Xamarin. iOS](~/ios/get-started/installation/index.md) .

### <a name="android"></a>Android

Для разработки приложений Android необходимо установить пакеты SDK для Java и Android. Они предоставляют компилятору, эмулятор и другие средства, необходимые для сборки, развертывания и тестирования. Java, пакет SDK для Android Google и инструменты Xamarin могут быть установлены и запущены в Windows и macOS. Рекомендуется использовать следующие конфигурации.

- Windows 10 с Visual Studio 2019
- macOS Можаве (10.11 +) с Visual Studio 2019 для Mac

Xamarin предоставляет единый установщик, который настраивает систему с использованием предварительных необходимых средств Java, Android и Xamarin (включая визуальный конструктор для макетов экрана). Подробные инструкции см. в [руководстве по установке Xamarin. Android](~/android/get-started/installation/index.md) .

Вы можете создавать и тестировать приложения на реальном устройстве без какой-либо лицензии Google, но распространять приложение через магазин (например, Google Play, Amazon или Барнса &amp; благородные), плата за регистрацию может взиматься с оператора. Google Play опубликует приложение мгновенно, а другие магазины будут иметь процесс утверждения, аналогичный Apple.

### <a name="windows"></a>Windows

Приложения Windows (WinForms, WPF или UWP) создаются с помощью Visual Studio. Они не используют Xamarin напрямую. Однако C# код можно совместно использовать в Windows, iOS и Android.
Посетите [центр разработки](https://developer.microsoft.com/) Майкрософт, чтобы узнать о средствах, необходимых для разработки приложений для Windows.

## <a name="creating-the-user-interface-ui"></a>Создание пользовательского интерфейса

Основное преимущество использования Xamarin заключается в том, что пользовательский интерфейс приложения использует собственные элементы управления на каждой платформе, создавая приложения, неразличимые из приложения, написанного на уровне цели-C или Java (для iOS и Android соответственно).

При создании экранов в приложении можно либо разместить элементы управления в коде, либо создать законченные экраны с помощью средств проектирования, доступных для каждой платформы.

### <a name="create-controls-programmatically"></a>Создание элементов управления программным способом

Каждая платформа позволяет добавлять элементы управления пользовательского интерфейса на экран с помощью кода. Это может занимать много времени, так как может быть трудно визуализировать завершенный проект при жестко кодировании координат точек и размеров элементов управления.

Однако программное создание элементов управления имеет свои преимущества, особенно в iOS для создания представлений, которые изменяют размер или отображаются по-разному в пределах размеров экрана iPhone и iPad.

### <a name="visual-designer"></a>Визуальный конструктор

Каждая платформа имеет разные методы для визуального размещения экранов:

- **iOS** — конструктор iOS в Xamarin упрощает создание представлений с помощью функций перетаскивания и полей свойств. Вместе эти представления составляют раскадровку, и к ним можно получить доступ в **. Файл раскадровки** , включенный в проект.
- **Android** — Xamarin предоставляет конструктор пользовательского интерфейса для Android с поддержкой перетаскивания для Visual Studio. Макеты экрана Android сохраняются как **. AXML** файлы при использовании инструментов Xamarin.
- **Windows** — Microsoft предоставляет конструктор пользовательского интерфейса для перетаскивания в Visual Studio и Blend. Макеты экрана хранятся в виде. Файлы XAML.

На этих снимках экрана показаны визуальные конструкторы экранов, доступные на каждой платформе:

 [![](understanding-the-xamarin-mobile-platform-images/designer-all1.png "На этих снимках экрана показаны визуальные конструкторы экранов, доступные на каждой платформе.")](understanding-the-xamarin-mobile-platform-images/designer-all1.png#lightbox)

Во всех случаях на элементы, создаваемые визуально, можно ссылаться в коде.

### <a name="user-interface-considerations"></a>Рекомендации по пользовательскому интерфейсу

Основное преимущество использования Xamarin для создания кросс-платформенных приложений заключается в том, что они могут использовать собственные наборы средств пользовательского интерфейса для предоставления привычного интерфейса пользователю. Пользовательский интерфейс также будет работать так же быстро, как и любое другое собственное приложение.

Некоторые метафоры пользовательского интерфейса работают на нескольких платформах (например, на всех трех платформах используется аналогичный элемент управления "список прокрутки"), но для того, чтобы ваше приложение работало правильно, при необходимости в ПОЛЬЗОВАТЕЛЬСКОМ интерфейсе необходимо использовать элементы пользовательского интерфейса, зависящие от платформы. Ниже приведены примеры метафор пользовательского интерфейса, зависящих от платформы.

- **iOS** — иерархическое перемещение с помощью кнопки мягкого возврата, вкладки в нижней части экрана.
- **Android** — аппаратная/системная — программная кнопка назад, меню действий, вкладки в верхней части экрана.
- **Windows** — приложения Windows могут работать на настольных компьютерах, планшетах (например, в Microsoft Surface) и телефонах. На устройствах Windows 10 может быть аппаратная кнопка Back и динамические плитки, например.

Рекомендуется ознакомиться с рекомендациями по проектированию, относящимися к целевым платформам.

- **iOS** — [рекомендации по работе с человеческим интерфейсом Apple](https://developer.apple.com/library/ios/documentation/UserExperience/Conceptual/MobileHIG/index.html)
- **Android** — [рекомендации по пользовательскому интерфейсу Google](https://developer.android.com/guide/practices/ui_guidelines/index.html)
- **Windows** — [рекомендации по проектированию для пользователей Windows](https://developer.microsoft.com/windows/design)

## <a name="library-and-code-re-use"></a>Повторное использование библиотеки и кода

Платформа Xamarin позволяет повторно использовать существующий C# код на всех платформах, а также интегрировать библиотеки, написанные изначально для каждой платформы.

### <a name="c-source-and-libraries"></a>C#Источник и библиотеки

Поскольку продукты Xamarin используют C# и .NET Framework, многие из существующих исходных кодов (проекты с открытым исходным кодом и собственными проектами) можно повторно использовать в проектах Xamarin. iOS или Xamarin. Android. Часто источник можно просто добавить в решение Xamarin, и он будет работать немедленно. Если используется неподдерживаемая функция .NET Framework, могут потребоваться некоторые настройки.

Примеры C# источников, которые можно использовать в Xamarin. iOS или Xamarin. Android, включают: SQLite-NET, NewtonSoft. JSON и Шарпзиплиб.

### <a name="objective-c-bindings--binding-projects"></a>Привязки цели-C и проекты привязки

Xamarin предоставляет средство с именем *btouch* , которое помогает создавать привязки, позволяющие использовать библиотеки цели-C в проектах Xamarin. iOS. Дополнительные сведения о том, как это сделать, см. в [документации по типам данных Binding-C](~/cross-platform/macios/binding/binding-types-reference.md) .

Примерами библиотек цели-C, которые можно использовать в Xamarin. iOS, являются: Сканирование штрихкодов Редласер, Google Analytics и интеграция PayPal. Привязки Xamarin. iOS с открытым исходным кодом доступны на сайте [GitHub](https://github.com/mono/monotouch-bindings).

### <a name="jar-bindings--binding-projects"></a>Привязки. jar + привязки проектов

Xamarin поддерживает использование существующих библиотек Java в Xamarin. Android. Дополнительные сведения об использовании см. в [документации по привязке библиотеки Java](~/android/platform/binding-java-library/index.md) . JAR-файл из Xamarin. Android.

Привязки Xamarin. Android с открытым исходным кодом доступны на сайте [GitHub](https://github.com/mono/monodroid-bindings).

### <a name="c-via-pinvoke"></a>C через PInvoke

Технология "вызов неуправляемого кода" (P/Invoke) позволяетC#управляемому коду () вызывать методы в собственных библиотеках, а также поддерживать собственные библиотеки для обратного вызова управляемого кода.

Например, Библиотека [SQLite-NET](https://github.com/praeclarum/sqlite-net) использует такие инструкции:

```csharp
[DllImport("sqlite3", EntryPoint = "sqlite3_open", CallingConvention=CallingConvention.Cdecl)]
public static extern Result Open (string filename, out IntPtr db);
```

Это привязывается к реализации SQLite в машинном код C-Language в iOS и Android.
Разработчики, знакомые с существующим API C, могут создать набор C# классов для соотнесения с собственным API и использовать существующий код платформы. Существует документация по [связыванию собственных библиотек](~/ios/platform/native-interop.md) в Xamarin. iOS. аналогичные принципы применимы к Xamarin. Android.

### <a name="c-via-cppsharp"></a>C++через Кппшарп

Мигель объясняет ККСКСИ (теперь называется [кппшарп](https://github.com/mono/CppSharp)) в своем [блоге](https://tirania.org/blog/archive/2011/Dec-19.html). Альтернативой непосредственной привязке C++ к библиотеке является создание оболочки C и привязка к ней через P/Invoke.
