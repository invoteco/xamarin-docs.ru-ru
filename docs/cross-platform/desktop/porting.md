---
ms.assetid: 814857C5-D54E-469F-97ED-EE1CAA0156BB
title: Руководство по переносу приложений для настольных компьютеров
description: Простое объяснение того, как отделить существующие Windows Forms или приложения WPF для создания кросс-платформенных приложений для работы в macOS, iOS, Android, а также UWP/Windows 10.
author: asb3993
ms.author: amburns
ms.date: 04/26/2017
ms.openlocfilehash: bdea1c472d95c86037056a2905679b43e12e0468
ms.sourcegitcommit: 1dd7d09b60fcb1bf15ba54831ed3dd46aa5240cb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/28/2019
ms.locfileid: "70120383"
---
# <a name="desktop-app-porting-guidance"></a>Руководство по переносу приложений для настольных компьютеров

Большая часть кода приложения может быть отнесена к одной из следующих областей:

- Код пользовательского интерфейса (например, окна и кнопки)
- сторонние элементы управления (например, диаграммы
- Бизнес-логика (например, правила проверки)
- Хранение локальных данных и доступ к ним
- Веб-службы и удаленный доступ к данным

Для приложений Windows Forms и WPF, написанных с помощью C# (или Visual Basic.NET), неудивительное количество бизнес-логики, доступ к локальным данным и веб-службы могут совместно использоваться различными платформами.

## <a name="net-portability-analyzer"></a>Анализатор переносимости .NET

Visual Studio 2017 и более поздней версии поддерживают [анализатор переносимости .NET](https://docs.microsoft.com/dotnet/articles/standard/portability-analyzer) ([загружаемый для Windows](https://marketplace.visualstudio.com/items?itemName=ConnieYau.NETPortabilityAnalyzer)), который может изучить имеющиеся приложения и узнать, сколько кода можно перенести "как есть" на другие платформы. Дополнительные сведения см. в [видео Channel 9](https://channel9.msdn.com/Blogs/Seth-Juarez/A-Brief-Look-at-the-NET-Portability-Analyzer).

Кроме того, можно загрузить средство командной строки из [анализатора переносимости на GitHub](https://github.com/Microsoft/dotnet-apiport) и использовать его для создания одних и тех же отчетов.

## <a name="x-of-my-code-is-portable-what-next"></a>"x% от моего кода является переносимым. Что дальше?»

Надеюсь, анализатор показывает, что большая часть кода является переносимой, но, безусловно, это будет часть всех приложений, которые _не могут_ быть перемещены на другие платформы.

Различные фрагменты кода, вероятно, будут находиться в одном из этих контейнеров, более подробно рассматриваются ниже:

- Повторное пригодность переносимого кода
- Код, требующий изменений
- Код, который не является переносимым, требует повторной записи

### <a name="re-useable-portable-code"></a>Повторное пригодность переносимого кода

Код .NET, написанный для API-интерфейсов, доступных на всех платформах, может быть создан на разных платформах без изменений. В идеале вы сможете переместить весь этот код в переносимую библиотеку классов, общую библиотеку или .NET Standard библиотеку, а затем протестировать ее в существующем приложении.

Затем эту общую библиотеку можно добавить в проекты приложений для других платформ (например, Android, iOS, macOS).

### <a name="code-that-requires-changes"></a>Код, требующий изменений

Некоторые API-интерфейсы .NET могут быть недоступны на всех платформах. Если эти API существуют в коде, необходимо переписать эти разделы, чтобы использовать межплатформенные API.

В качестве примера можно привести использование API-интерфейсов отражения, доступных в .NET 4,6, но недоступных на всех платформах.

После повторного написания кода с помощью переносимых API-интерфейсов вы сможете упаковать этот код в общую библиотеку и протестировать его в существующем приложении.

### <a name="code-that-isnt-portable-and-requires-a-re-write"></a>Код, который не является переносимым, требует повторной записи

Ниже приведены примеры кода, который не является межплатформенным.

- **Пользовательский интерфейс** — это Windows Forms или экраны WPF, например, не могут использоваться в проектах в Android или iOS. Необходимо переписать пользовательский интерфейс, используя [Сравнение элементов управления](~/cross-platform/desktop/controls/index.md) в качестве ссылки.

- **Зависящий от платформы код хранилища** , основанный на технологии конкретной платформы (например, в локальной базе данных SQL Server Express). Его необходимо будет переписать с помощью альтернативной платформы (например, SQLite для ядра СУБД).
Некоторые операции файловой системы также могут быть скорректированы, так как в платформе UWP несколько других интерфейсов API для Android и iOS (например, в некоторых файловых системах учитывается регистр, а другие — нет).

- **компоненты сторонних производителей** — проверьте, доступны ли на других платформах сторонние компоненты в ваших приложениях. Некоторые, например, невизуальные пакеты NuGet, могут быть доступны, но другие (особенно визуальные элементы управления, такие как диаграммы или мультимедийные проигрыватели).

## <a name="tips-for-making-code-portable"></a>Советы по созданию переносимого кода

- **Внедрение зависимостей** — предоставьте различные реализации для каждой платформы и

- **Многоуровневый подход** — будь то MVVM, MVC, MVP или другой шаблон, который помогает отделить переносимый код от кода, зависящего от платформы.

- **Обмен сообщениями** — передача сообщений в коде можно использовать для отмены связей между различными частями приложения.
