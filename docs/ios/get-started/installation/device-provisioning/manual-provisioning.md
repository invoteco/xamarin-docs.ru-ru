---
title: Ручная подготовка для Xamarin.iOS
description: После успешной установки Xamarin.iOS следующим шагом в разработке приложений для iOS является подготовка устройства iOS. Это руководство описывает, как использовать ручную подготовку для настройки сертификатов и профилей разработки.
ms.prod: xamarin
ms.assetid: E26ACC94-F4A5-4FF5-B7D4-BE596745A665
ms.technology: xamarin-ios
author: davidortinau
ms.author: daortin
ms.date: 03/06/2020
ms.openlocfilehash: 04cb1b9303e571b2a10cdfa621dcd312162e2893
ms.sourcegitcommit: eca3b01098dba004d367292c8b0d74b58c4e1206
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/13/2020
ms.locfileid: "79303753"
---
# <a name="manual-provisioning-for-xamarinios"></a>Ручная подготовка для Xamarin.iOS

_Установив Xamarin.iOS для разработки приложений для iOS можно приступать к подготовке устройства iOS. Это руководство описывает, как использовать ручную подготовку для настройки сертификатов и профилей разработки._

> [!NOTE]
> Инструкции на этой странице предназначены для разработчиков с платным доступом к программе для разработчиков Apple. Если у вас бесплатная учетная запись, обратитесь к руководству [Бесплатная подготовка](~/ios/get-started/installation/device-provisioning/free-provisioning.md) для получения дополнительных сведений о тестировании на устройствах.

## <a name="create-a-development-certificate"></a>Создание сертификата разработки

Первым шагом в настройке устройства для разработки является создание сертификата для подписи. Сертификат для подписи состоит из двух компонентов:

- сертификата разработки;
- закрытого ключа.

Сертификаты разработки и связанные [ключи](#understanding-certificate-key-pairs) критически важны для разработчика iOS: они являются его удостоверением в Apple и связывают его с определенным устройством и профилем разработки. Они действуют подобно цифровой подписи, добавляемой к приложению. Apple проверяет сертификаты для управления доступом к устройствам, на которых разрешено развертывание.

Командами разработчиков, сертификатами и профилями можно управлять в разделе [Сертификаты, идентификаторы и профили](https://developer.apple.com/account/resources/certificates/list) (требуется вход в систему) в Центре пользователей Apple. Apple требует наличия удостоверения подписывания для создания кода для устройства или симулятора.  

> [!IMPORTANT]
> Важно отметить, что одновременно можно иметь только два сертификата разработки iOS. Чтобы создать еще один сертификат, необходимо отозвать один из имеющихся. Компьютер с отозванным сертификатом не сможет подписать приложение.

Прежде чем начинать процесс подготовки вручную, следует убедиться, что в Visual Studio добавлена учетная запись разработчика Apple, как описано в руководстве [Управление учетными записями Apple](~/cross-platform/macios/apple-account-management.md). После добавления учетной записи разработчика Apple выполните следующие действия, чтобы создать сертификат для подписи.

1. Перейдите в окно "Учетные записи разработчика Apple" в Visual Studio.
    1. Mac: **Visual Studio > Настройки > Учетная запись разработчика Apple**
    2. Windows: **Средства > Параметры > Xamarin > Учетные записи Apple**

2. Выберите команду и щелкните **Показать подробности…**
3. Щелкните **Создать сертификат** и выберите **Разработка Apple** или **Разработка iOS**. Если у вас есть соответствующие разрешения, через несколько секунд появится новое удостоверение подписывания.

### <a name="understanding-certificate-key-pairs"></a>Основные сведения о парах ключей сертификатов

Профиль разработчика содержит сертификаты, связанные с ними ключи, а также профили подготовки, связанные с учетной записью. По сути, существуют две версии профиля разработчика: одна на портале разработчика, а другая на локальном компьютере Mac. Различие между ними — в типе ключей, которые они содержат: _профиль на портале вмещает все открытые ключи, связанные с вашими сертификатами, а копия на локальном компьютере Mac содержит все закрытые ключи_. Чтобы сертификаты были действительны, пары ключей должны совпадать.

> [!WARNING]
> Потеря сертификата и связанных с ним ключей может надолго остановить работу, так как потребуется отозвать существующие сертификаты и повторно подготовить все связанные устройства, включая зарегистрированные для специального развертывания. Успешно настроив сертификаты разработки, экспортируйте резервную копию и сохраните ее в надежном месте. Дополнительные сведения о выполнении этой задачи см. в разделе "Exporting and Importing Certificates and Profiles" (Экспорт и импорт сертификатов и профилей) руководства [Maintaining Certificates](https://developer.apple.com/library/ios/documentation/IDEs/Conceptual/AppDistributionGuide/MaintainingCertificates/MaintainingCertificates.html) (Обслуживание сертификатов) в документации Apple.

<a name="provisioning" />

## <a name="provision-an-ios-device-for-development"></a>Подготовка устройства iOS к разработке

Создав удостоверение в Apple и получив сертификат разработки, необходимо настроить профиль подготовки и требуемые сущности, чтобы получить возможность развертывать приложение на устройстве Apple. На устройстве должна быть версия iOS, поддерживаемая Xcode. Может потребоваться обновить устройство, среду Xcode или и то, и другое.

<a name="adddevice" />

## <a name="add-a-device"></a>Добавление устройства

При создании профиля подготовки для разработки необходимо указать, на каких устройствах может выполняться приложение. Для этого на портал разработки можно добавить до 100 устройств за календарный год, а затем выбрать из их числа те устройства, которые следует добавить в определенный профиль подготовки. Чтобы добавить устройство на портал разработки, на компьютере Mac сделайте следующее.

1. Подключите подготавливаемое устройство к компьютеру Mac с помощью USB-кабеля из комплекта поставки.
2. Откройте Xcode и перейдите к разделу **Окно > Устройства и симуляторы**.
3. На вкладке **Устройства** выберите устройство в меню слева.
4. Выделите строку в поле **Identifier** (Идентификатор) и скопируйте ее в буфер обмена:

   ![Окно устройств и симуляторов Xcode с выделенным расположением строки идентификатора iOS.](manual-provisioning-images/xcode-devices.png)

5. В веб-браузере перейдите в раздел [устройств на портале разработчика](https://developer.apple.com/account/resources/devices/list) и нажмите кнопку **+** :

   ![Снимок экрана: страница "Устройства" на сайте разработчика Apple с выделенной кнопкой "Добавить".](manual-provisioning-images/developer-portal-devices.png)

6. Задайте правильную **платформу** и укажите имя нового устройства. Вставьте идентификатор, скопированный ранее, в поле **Идентификатор устройства**:

    ![Снимок экрана: страница регистрации устройств с правильно заполненными полями.](manual-provisioning-images/new-device-info.png)

7. Нажмите кнопку **Продолжить**.
8. Проверьте информацию и нажмите кнопку **Зарегистрировать**.

Повторите описанные выше действия для всех устройств iOS, которые будут использоваться для тестирования или отладки приложения Xamarin.iOS.

<a name="provisioningprofile" />

## <a name="create-a-development-provisioning-profile"></a>Создание профиля подготовки для разработки

После добавления устройства на портал разработчика необходимо создать профиль подготовки и добавить в него устройство. 

Перед созданием профиля подготовки необходимо создать *идентификатор приложения*. Идентификатор приложения — это строка в обратном стиле DNS, однозначно определяющая приложение. Ниже показано, как создать **шаблон идентификатора приложения**, который можно использовать для создания и установки большинства приложений. **Явный идентификатор приложения** позволяет устанавливать только одно приложение (с соответствующим идентификатором пакета) и, как правило, применяется для определенных функций iOS, таких как Apple Pay и HealthKit. Сведения о создании явных идентификаторов приложений см. в руководстве [Работа с возможностями](~/ios/deploy-test/provisioning/capabilities/index.md).

### <a name="new-wildcard-app-id"></a>Шаблон идентификатора приложения

1. Перейдите в раздел [идентификаторов на портале разработчика](https://developer.apple.com/account/resources/identifiers/list) и нажмите кнопку **+** .
2. Выберите **Идентификаторы приложений** и щелкните **Продолжить**.
3. Укажите **Описание**. Затем задайте для параметра **Идентификатор пакета** значение **Подстановочный знак** и введите идентификатор в формате `com.[DomainName].*`:

   ![Снимок экрана: страница регистрации идентификатора приложения с заполненными обязательными полями.](manual-provisioning-images/new-app-id.png)

4. Нажмите кнопку **Продолжить**.
5. Проверьте информацию и нажмите кнопку **Зарегистрировать**.

### <a name="new-provisioning-profile"></a>Новый профиль подготовки

После создания идентификатора приложения можно создать профиль подготовки. Профиль подготовки содержит сведения о том, с *каким* приложением (или приложениями в случае с шаблоном идентификатора приложения) связан этот профиль, *кто* может его использовать (в зависимости от добавленных сертификатов разработчика) и на *каких* устройствах можно установить приложение.

Чтобы вручную создать профиль подготовки для разработки, выполните указанные ниже действия.

1. Перейдите в раздел [профилей на портале разработчика](https://developer.apple.com/account/resources/profiles/list) и нажмите кнопку **+** .

2. В разделе **Разработка** выберите **Разработка приложений iOS** и щелкните **Продолжить**.

3. Выберите идентификатор приложения для использования из раскрывающегося меню, а затем щелкните **Продолжить**.

4. Выберите сертификаты, которые нужно включить в профиль подготовки, и нажмите кнопку **Продолжить**.

5. Выберите все устройства, на которых будет устанавливаться приложение, и щелкните **Продолжить**.

6. Укажите **Имя профиля подготовки** и щелкните **Создать**.

7. При необходимости можно нажать **Загрузить** на следующей странице, чтобы загрузить профиль подготовки на компьютер Mac.

<a name="download" />

## <a name="download-provisioning-profiles-in-visual-studio"></a>Загрузка профилей подготовки в Visual Studio.

После создания нового профиля подготовки на портале разработчика Apple используйте Visual Studio для его загрузки, чтобы он был доступен для подписывания пакета в приложении.

1. Перейдите в окно "Учетные записи разработчика Apple" в Visual Studio.
    1. Mac: **Visual Studio > Настройки > Учетная запись разработчика Apple**
    2. Windows: **Средства > Параметры > Xamarin > Учетные записи Apple**

2. Выберите команду и щелкните **Показать подробности…**
3. Убедитесь, что новый профиль отображается в списке **Профили подготовки**. При необходимости перезапустите Visual Studio, чтобы обновить список. 
4. Щелкните **Загрузить все профили**.

Теперь новый профиль подготовки будет доступен в Visual Studio и готов к использованию.

## <a name="deploy-to-a-device"></a>Развертывание на устройство

На этом этапе подготовка должна быть завершена, а приложение готово к развертыванию на устройстве. Для этого выполните следующие действия.

# <a name="visual-studio-for-mac"></a>[Visual Studio для Mac](#tab/macos)

1. Подключите устройство к компьютеру Mac.
2. Откройте файл **Info.plist** и проверьте, соответствует ли **идентификатор пакета** созданному ранее идентификатору приложения (если только не используется шаблон идентификатора приложения).
3. В разделе **Подписывание** выберите **Подготовка вручную** в качестве параметра **Схема**:

    ![Снимок экрана: Info.plist в Visual Studio для Mac с выбранной подготовкой вручную](manual-provisioning-images/vsm-info-plist.png)

4. Щелкните **Параметры подписывания пакета...**
5. Убедитесь, что для конфигурации сборки задано значение **Отладка | iPhone**. Откройте раскрывающиеся меню **Удостоверение подписывания** и **Профиль подготовки**, чтобы убедиться в том, что указаны правильные сертификаты и профили подготовки: 

   ![Страница свойств подписывания пакета iOS с раскрывающимся меню "Профиль подготовки", где отображаются все доступные профили подготовки для приложения.](manual-provisioning-images/vsm-bundle-signing.png)

6. Выберите определенное удостоверение и профиль для использования или оставьте значение **Автоматически**. Если выбрано значение **Автоматически**, среда Visual Studio для Mac выберет удостоверение и профиль в соответствии со значением **Идентификатор пакета** в файле **Info.plist**. 
7. Нажмите кнопку **ОК**.
8. Нажмите **Запустить**, чтобы развернуть приложение на устройстве.


# <a name="visual-studio"></a>[Visual Studio](#tab/windows)

1. Подключите устройство к узлу сборки Mac.
2. Откройте файл **Info.plist** и проверьте, соответствует ли **идентификатор пакета** созданному ранее идентификатору приложения (если только не используется шаблон идентификатора приложения).
3. В **обозревателе решений** щелкните правой кнопкой мыши имя проекта iOS, выберите пункт **Свойства** и перейдите на вкладку **Подписывание пакета iOS**.
4. Убедитесь, что для конфигурации сборки задано значение **Отладка | iPhone**. В разделе **Подписывание пакета** выберите **Подготовка вручную** в качестве параметра **Схема**:

    ![Снимок экрана: Info.plist в Visual Studio для Mac с выбранной подготовкой вручную](manual-provisioning-images/vs-bundle-signing.png)

5. Откройте раскрывающиеся меню **Удостоверение подписывания** и **Профиль подготовки**, чтобы убедиться в том, что указаны правильные сертификаты и профили подготовки.
6. Выберите определенное удостоверение и профиль для использования или оставьте значение **Автоматически**. Если выбрано значение **Автоматически**, среда Visual Studio выберет удостоверение и профиль в соответствии со значением **Идентификатор пакета** в файле **Info.plist**. 
7. Нажмите **Запустить**, чтобы развернуть приложение на устройстве.

-----

## <a name="provisioning-for-application-services"></a>Подготовка служб приложений

Apple предоставляет ряд специальных служб приложений, также называемых возможностями, которые можно активировать для приложений Xamarin.iOS. Эти службы необходимо настроить как на портале подготовки iOS при создании **идентификатора приложения**, так и в файле **Entitlements.plist**, входящем в проект приложения Xamarin.iOS. Сведения о добавлении служб приложений к приложению см. в руководствах [Работа с возможностями](~/ios/deploy-test/provisioning/capabilities/index.md) и [Работа с назначениями](~/ios/deploy-test/provisioning/entitlements.md).

- Создайте идентификатор приложения с требуемыми службами приложений.
- Создайте [профиль подготовки](#provisioningprofile), содержащий этот идентификатор приложения.
- Задайте назначения в проекте Xamarin.iOS

## <a name="related-links"></a>Связанные ссылки

- [Бесплатная подготовка](~/ios/get-started/installation/device-provisioning/free-provisioning.md)
- [Распространение приложений](~/ios/deploy-test/app-distribution/index.md)
- [Устранение неполадок](~/ios/deploy-test/troubleshooting.md)
- [Руководство Apple. Распространение приложений](https://developer.apple.com/library/ios/documentation/IDEs/Conceptual/AppDistributionGuide/Introduction/Introduction.html)
