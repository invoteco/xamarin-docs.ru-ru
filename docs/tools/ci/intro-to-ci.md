---
title: Введение в непрерывную интеграцию с Xamarin
description: В этом документе описывается непрерывная интеграция с Xamarin. В нем рассматривается управление версиями и различные среды непрерывной интеграции.
ms.prod: xamarin
ms.assetid: C034200E-2947-4309-9DDD-80DAC505C43F
author: davidortinau
ms.author: daortin
ms.date: 07/19/2017
ms.openlocfilehash: 2862f05f2d183c9345d2b92268ddf2101cc2492e
ms.sourcegitcommit: 2fbe4932a319af4ebc829f65eb1fb1816ba305d3
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/29/2019
ms.locfileid: "73029815"
---
# <a name="introduction-to-continuous-integration-with-xamarin"></a>Введение в непрерывную интеграцию с Xamarin

_Непрерывная интеграция — это методика разработки программного обеспечения, при которой автоматизированная сборка компилируется и при необходимости тестирует приложение при добавлении или изменении кода разработчиками в репозитории управления версиями проекта. В этой статье обсуждаются общие понятия непрерывной интеграции и некоторые варианты непрерывной интеграции с проектами Xamarin._

В проектах программного обеспечения часто разработчики работают параллельно. В какой-то момент необходимо интегрировать все эти параллельные потоки работы в одну базу кода, составляющую окончательный продукт. В ранних днях разработки программного обеспечения эта интеграция была выполнена в конце проекта, что было сложным и рискованным процессом.

Непрерывная интеграция (CI) позволяет избежать подобных сложностей, объединяя изменения каждого разработчика в общую базу кода на постоянной основе, обычно каждый раз, когда любой разработчик проверяет изменения в репозитории общего кода проекта. Каждый возврат инициирует автоматическую сборку и запускает автоматические тесты, чтобы убедиться, что вновь введенный код не нарушает существующий код.  Таким образом, элемент непрерывной интеграции немедленно выдает ошибки и проблемы и гарантирует, что все члены группы останутся в актуальном состоянии. Это приводит к согласованной и стабильной базе кода.

Системы непрерывной интеграции имеют две основные части:

- **Управление версиями — Управление** ВЕРСИЯМИ (VC), также называемое системой управления версиями или исходным кодом, объединяет весь код проекта в один общий репозиторий и хранит полный журнал каждого изменения каждого файла. Этот репозиторий, часто называемый *магистральной* или *главной* ветвью, содержит исходный код, который в конечном итоге будет использоваться для создания рабочей или окончательной версии приложения. Для этой задачи существует множество продуктов с открытым исходным кодом и коммерческой продукцией, что обычно позволяет группам или отдельным лицам разветвление копии кода в дополнительные ветви, где они могут вносить значительные изменения или проводить эксперименты без риска в главной ветви. После проверки изменений в вторичной ветви их можно объединить обратно в главную ветвь.
- **Сервер** непрерывной интеграции — сервер непрерывной интеграции отвечает за сбор всех артефактов проекта (исходный код, изображения, видео, базы данных, автоматические тесты и т. д.), компиляцию приложения и выполнение автоматических тестов. Опять же, существует множество средств с открытым исходным кодом и коммерческими серверами непрерывной интеграции.

Разработчики обычно имеют рабочую копию одной или нескольких ветвей на рабочих станциях, где работа изначально выполняется. После того как соответствующий набор работ будет завершен, изменения будут возвращены в соответствующую ветвь, которая будет распространяться на рабочие копии других разработчиков. Таким образом команда гарантирует, что все они работают над одним и тем же кодом.

Опять же, с непрерывной интеграцией действие фиксации изменений приводит к тому, что сервер НЕПРЕРЫВной интеграции создает проект и выполняет автоматические тесты для проверки правильности исходного кода. При наличии ошибок сборки или сбоев тестов сервер CI уведомляет ответственного разработчика (через электронную почту, мгновенные сообщения, Twitter, Гровл и т. д.), поэтому он может устранить проблему. (Серверы CI могут даже отклонять фиксацию в случае сбоев, которые называются "условным возвратом".)

Этот процесс показан на следующей схеме:

[![](intro-to-ci-images/intro01-small.png "This diagram illustrates this process")](intro-to-ci-images/intro01.png#lightbox)

Мобильные приложения предоставляют уникальные задачи для непрерывной интеграции. Для приложений могут потребоваться такие датчики, как GPS или камера, доступные только на физических устройствах. Кроме того, Симуляторы или Эмуляторы являются приближением к оборудованию и могут скрывать или скрывать проблемы. В итоге необходимо протестировать мобильное приложение на реальном оборудовании, чтобы быть уверенным, что он действительно готов к работе с клиентами.

[Тест в центре приложений](https://docs.microsoft.com/appcenter/test-cloud) решает эту конкретную проблему, проверяя приложения непосредственно на сотнях физических устройств. Разработчики пишут автоматизированные приемочные тесты, позволяющие использовать мощные средства тестирования пользовательского интерфейса. После отправки этих тестов в центр приложений сервер CI может автоматически запускать их в рамках процесса непрерывной интеграции, как показано на следующей схеме:

[![](intro-to-ci-images/intro02-small.png "Once these tests are uploaded to App Center, the CI server can run them automatically as part of a CI process as shown in this diagram")](intro-to-ci-images/intro02.png#lightbox)

## <a name="components-of-continuous-integration"></a>Компоненты непрерывной интеграции

Существует обширная экосистема коммерческих и средств с открытым кодом, предназначенных для поддержки CI. В этом разделе описываются некоторые из наиболее распространенных.

### <a name="version-control"></a>Управление версиями

#### <a name="azure-devops-and-team-foundation-server"></a>DevOps и Team Foundation Server Azure

[Azure DevOps](https://azure.microsoft.com/services/devops/) and [Team Foundation Server](https://visualstudio.microsoft.com/tfs/) (TFS) — это средства совместной работы Майкрософт для служб сборки непрерывной интеграции, отслеживание задач, гибкие средства планирования и создания отчетов, а управление версиями. С помощью системы управления версиями Azure DevOps и TFS могут работать со своей собственной системой (система управления версиями Team Foundation или TFVC) или с проектами, размещенными на сайте GitHub.

- Azure DevOps предоставляет службы через облако. Его основное преимущество заключается в том, что для него не требуется специальное оборудование или инфраструктура, и к ним можно получить доступ из любого места через веб-браузеры и через популярные средства разработки, такие как Visual Studio, что делает его привлекательным для команд, которые географически распределены . Он предоставляется бесплатно для групп с пятью разработчиками или менее, после чего можно приобрести дополнительные лицензии для поддержки растущей команды.
- TFS предназначен для локальных серверов Windows и доступен через локальную сеть или VPN-подключение к этой сети. Его основное преимущество заключается в том, что вы полностью управляете конфигурацией серверов сборки и можете установить любое дополнительное программное обеспечение или службы. В TFS имеется бесплатный экспресс-выпуск для небольших команд.

Как TFS, так и Azure DevOps тесно интегрированы с Visual Studio и позволяют разработчикам выполнять множество задач управления версиями и CI с помощью одной интегрированной среды разработки. Также доступен подключаемый модуль Team Explorer Everywhere для Eclipse (см. ниже). В Visual Studio для Mac [доступен предварительный просмотр TFVC](/visualstudio/mac/tf-version-control/).

[Конвейеры Azure DevOps](https://docs.microsoft.com/azure/devops/pipelines/languages/xamarin/) имеют прямую поддержку для проектов Xamarin, в которых вы создаете определение сборки для каждой целевой платформы (Android, iOS и Windows). Для каждого определения сборки требуется соответствующая лицензия Xamarin. Для этой цели также можно подключить локальный сервер сборки TFS с поддержкой Xamarin в Azure DevOps. При такой настройке сборки, поставленные в очередь на Azure DevOps, будут делегированы на локальный сервер. Дополнительные сведения см. в разделе [агенты сборки и выпуска](https://docs.microsoft.com/azure/devops/pipelines/agents/agents). Кроме того, можно использовать другое средство построения, например Jenkins или Team City.

Полную сводку по всем функциям управления жизненным циклом приложений (ALM) Visual Studio, Azure DevOps и Team Foundation Server см. в статье [DevOps с приложениями Xamarin](https://docs.microsoft.com/visualstudio/cross-platform/application-lifecycle-management-alm-with-xamarin-apps).

#### <a name="team-explorer-everywhere"></a>Team Explorer Everywhere

[Team Explorer Everywhere](https://docs.microsoft.com/azure/devops/java/download-eclipse-plug-in/) предоставляет возможности Team Foundation Server и Azure DevOps для групп, разработанных за пределами Visual Studio. Она позволяет разработчикам подключаться к командным проектам локально или в облаке из Eclipse или кросс-платформенного клиента командной строки для OS X и Linux. Team Explorer Everywhere предоставляет полный доступ к системе управления версиями (включая Git), рабочим элементам и возможностям сборки для платформ, отличных от Windows.

#### <a name="git"></a>Git

[Git](https://git-scm.com) — это популярное решение для управления версиями с открытым исходным кодом, изначально разработанное для управления исходным текстом ядра Linux. Это очень быстрая и гибкая система, которая популярна в проектах программного обеспечения любого размера. Он легко масштабируется от отдельных разработчиков с плохим доступом в Интернет к большим командам, охватывающим глобус. Git также делает ветвление очень простым, что, в свою очередь, может способствовать параллельному потокам разработки с минимальным риском.

Git может полностью работать через веб-браузеры или [Клиенты GUI](https://git-scm.com/downloads/guis) , работающие под управлением Linux, Mac OSX и Windows. Он предоставляется бесплатно для общедоступных репозиториев; для частных репозиториев требуется [платный план](https://github.com/pricing).

Текущие версии Visual Studio для Windows и Mac предоставляют встроенную поддержку Git. Корпорация Майкрософт предоставляет [загружаемое расширение для Git](https://visualstudiogallery.msdn.microsoft.com/abafc7d6-dcaa-40f4-8a5e-d6724bdb980c) в более ранних версиях Visual Studio. Как отмечалось выше, Azure DevOps и TFS могут использовать Git для управления версиями вместо TFVC.

#### <a name="subversion"></a>Subversion

[Subversion](https://subversion.apache.org) (SVN) — это популярная система управления версиями с открытым исходным кодом, которая уже используется с 2000. Служба SVN работает во всех современных версиях OS X, Windows, FreeBSD, Linux и UNIX. Visual Studio для Mac имеет встроенную поддержку SVN. Существуют сторонние расширения, которые обеспечивают поддержку SVN в Visual Studio.

### <a name="continuous-integration-environments"></a>Среды с непрерывной интеграцией

Настройка среды с непрерывной интеграцией означает объединение системы управления версиями со службой сборки.  Для второго варианта используются два наиболее распространенных из них:

- [Azure pipelines](https://docs.microsoft.com/azure/devops/pipelines/) — это система сборки Azure DEVOPS и TFS. Она тесно интегрирована с Visual Studio, что позволяет разработчикам запускать сборки, автоматически выполнять тесты и просматривать результаты.
- Jenkins — это сервер CI с открытым исходным кодом с обширной экосистемой подключаемых модулей для поддержки всех видов разработки программного обеспечения. Она выполняется в Windows, а Mac OS X. Jenkins не интегрирована с какой-либо конкретной интегрированной средой разработки. Вместо этого он настраивается и управляется через веб-интерфейс. Jenkins CI также легко установить и настроить, что делает его привлекательным для небольших команд.

Вы можете использовать TFS или Azure DevOps самостоятельно. также можно использовать Jenkins в сочетании с TFS/Azure DevOps или Git, как описано в следующих разделах.

#### <a name="azure-devops-and-team-foundation-server"></a>DevOps и Team Foundation Server Azure

Как уже говорилось, Azure DevOps и Team Foundation Server предоставляет как управление версиями, так и службы сборки. Службам сборок всегда требуется лицензия Xamarin Business или Enterprise для каждой целевой платформы.

С помощью Azure DevOps создайте отдельное определение сборки для каждой целевой платформы и введите в нем соответствующую лицензию. После настройки Azure DevOps будет выполнять сборки и тесты в облаке. Дополнительные сведения см. в разделе [Azure pipelines](https://docs.microsoft.com/azure/devops/pipelines/) .

При использовании Team Foundation Server компьютер сборки настраивается следующим образом для конкретных целевых платформ:

- **Android и Windows:** Установите Visual Studio и инструменты Xamarin (для Android и Windows) и настройте с помощью лицензий Xamarin. Также необходимо переместить пакет SDK для Android в общую папку на сервере, где агент сборки TFS может его найти. Дополнительные сведения см. в разделе [Настройка TFVC](https://docs.microsoft.com/azure/devops/repos/tfvc/overview).
- **iOS и Xamarin:** Установите Visual Studio и инструменты Xamarin на Windows Server с соответствующей лицензией. Затем установите Visual Studio для Mac на компьютере Mac OS X, доступном для сети, который будет служить узлом сборки, и создайте окончательный пакет приложения (IPA для iOS, APP для OS X).

Эта топографии показана на схеме ниже.

[![](intro-to-ci-images/intro03-small.png "This diagram illustrates this topography")](intro-to-ci-images/intro03.png#lightbox)

Также можно связать локальный сервер TFS с проектом Azure DevOps, чтобы сборки DevOps Azure были делегированы локальному серверу. Дополнительные сведения см. в разделе [агенты сборки и выпуска](https://docs.microsoft.com/azure/devops/pipelines/agents/agents/).

#### <a name="azure-devops-and-jenkins"></a>Azure DevOps и Jenkins

Если вы используете Jenkins для создания приложений, вы можете сохранить код в Azure DevOps или Team Foundation Server и продолжить использовать Jenkins для сборок CI. Вы можете активировать сборку Jenkins при отправке кода в репозиторий Git командного проекта или при возврате кода в TFVC. Дополнительные сведения см. [в статье Jenkins with Azure DevOps](https://docs.microsoft.com/azure/devops/service-hooks/services/jenkins).

[![](intro-to-ci-images/intro04-small.png "If you use Jenkins to build your apps, you can store your code in Azure DevOps or Team Foundation Server and continue to use Jenkins for your CI builds")](intro-to-ci-images/intro04.png#lightbox)

#### <a name="git-and-jenkins"></a>Git и Jenkins

Другая распространенная среда CI может быть полностью основана на версии OS X. В этом сценарии используется Git для управления исходным кодом и Jenkins для сервера сборки. Оба они работают на одном Mac OS X компьютере с установленной Visual Studio для Mac. Это очень похоже на среду Azure DevOps + Jenkins, о которой говорилось в предыдущем разделе:

[![](intro-to-ci-images/intro05-small.png "This is very similar to the Azure DevOps + Jenkins environment discussed in the previous section")](intro-to-ci-images/intro05.png#lightbox)

> [!IMPORTANT]
> **Jenkins [не поддерживается корпорацией Майкрософт](~/cross-platform/troubleshooting/questions/xamarin-jenkins.md).**
