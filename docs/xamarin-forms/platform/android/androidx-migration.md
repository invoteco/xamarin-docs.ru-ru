---
title: Андроидкс миграция в Xamarin. Forms
description: В этой статье объясняется, почему Андроидкс существует и как выполнить миграцию в Андроидкс в приложении Xamarin. Forms.
ms.prod: xamarin
ms.assetid: 98884003-E65A-4EB4-842D-66CFE27344A4
ms.technology: xamarin-forms
author: profexorgeek
ms.author: jusjohns
ms.date: 01/22/2020
ms.openlocfilehash: 13fb802dec326cdb82bac8825ca84343ef85b13e
ms.sourcegitcommit: 10b4d7952d78f20f753372c53af6feb16918555c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/26/2020
ms.locfileid: "77646656"
---
# <a name="androidx-migration-in-xamarinforms"></a>Андроидкс миграция в Xamarin. Forms

Андроидкс заменяет библиотеку поддержки Android. В этой статье объясняется, почему Андроидкс существует, как она влияет на Xamarin. Forms и как перенести приложение для использования библиотек Андроидкс.

## <a name="history-of-androidx"></a>Журнал Андроидкс

Библиотека поддержки Android была создана для предоставления более новых функций в более старых версиях Android. Это уровень совместимости, позволяющий разработчикам использовать функции, которые могут отсутствовать во всех версиях операционной системы Android и иметь корректное резервное использование для старых версий. Библиотека поддержки также содержит удобные и вспомогательные классы, средства отладки и служебные программы, а также сложные классы, которые зависят от других классов библиотеки поддержки для работы.

Хотя библиотека поддержки изначально была единственной двоичной, она увеличилась и развивалась в наборе библиотек, которые практически необходимы для разработки современных приложений. Ниже приведены некоторые из наиболее часто используемых функций из библиотеки поддержки.

- Класс поддержки `Fragment`.
- `RecyclerView`, используемый для управления длинными списками.
- Поддержка Multidex для приложений с более чем 65 536 методами.
- Класс `ActivityCompat`.

Андроидкс — это замена библиотеки поддержки, которая больше не поддерживается — все новые библиотеки будут разрабатываться в библиотеке Андроидкс. Андроидкс — это переработанная Библиотека, использующая семантическое управление версиями, более четкие имена пакетов и обеспечивающая лучшую поддержку распространенных шаблонов архитектуры приложений. Андроидкс версии 1.0.0 — это двоичный эквивалент для поддержки библиотеки версии 28.0.0. Полный список сопоставлений классов из библиотеки поддержки в Андроидкс см. в разделе [Поддержка сопоставления классов библиотеки](https://developer.android.com/jetpack/androidx/migrate/class-mappings) в Developer.Android.com.

Google создал процесс миграции с именем Жетифиер и Андроидкс. Жетифиер проверяет байт-код JAR-кода во время сборки и повторно сопоставляет ссылки на библиотеки поддержки как в коде приложения, так и в зависимостях, в их эквивалент Андроидкс.

В приложении Xamarin. Forms, как и в Java-приложении Android, зависимости JAR должны быть перенесены в Андроидкс. Однако привязки Xamarin также необходимо перенести, чтобы они указывали на правильные, базовые JAR-файлы. В версии 4,5 добавлена поддержка автоматической миграции Андроидкс в Xamarin. Forms.

Дополнительные сведения о Андроидкс см. в разделе [Обзор андроидкс](https://developer.android.com/jetpack/androidx) на Developer.Android.com.

## <a name="automatic-migration-in-xamarinforms"></a>Автоматическая миграция в Xamarin. Forms

Для автоматического перехода на Андроидкс проект Xamarin. Forms должен:

- Целевой API Android версии 29 или более поздней.
- Используйте Xamarin. Forms версии 4,5 или более поздней.

После подтверждения этих параметров в проекте создайте приложение Android в Visual Studio 2019. В процессе сборки промежуточный язык (IL) проверяется, и поддержка зависимостей и привязок библиотеки заменяется зависимостями Андроидкс. Если приложение содержит все зависимости Андроидкс, необходимые для сборки, в процессе сборки не будет различий.

> [!NOTE]
> Необходимо поддерживать ссылки на библиотеку поддержки в проекте. Они используются для компиляции приложения до того, как процесс миграции проверит полученный IL и преобразует зависимости.

Если обнаруживаются зависимости Андроидкс, которые не являются частью проекта, то сообщается об ошибке сборки, которая указывает, какие пакеты Андроидкс отсутствуют. Ниже приведен пример ошибки сборки.

```
Could not find 37 AndroidX assemblies, make sure to install the following NuGet packages:
- Xamarin.AndroidX.Lifecycle.LiveData
- Xamarin.AndroidX.Browser
- Xamarin.Google.Android.Material
- Xamarin.AndroidX.Legacy.Supportv4
You can also copy and paste the following snippit into your .csproj file:
 <PackageReference Include="Xamarin.AndroidX.Lifecycle.LiveData" Version="2.1.0-rc1" />
 <PackageReference Include="Xamarin.AndroidX.Browser" Version="1.0.0-rc1" />
 <PackageReference Include="Xamarin.Google.Android.Material" Version="1.0.0-rc1" />
 <PackageReference Include="Xamarin.AndroidX.Legacy.Support.V4" Version="1.0.0-rc1" />
```

Отсутствующие пакеты NuGet могут быть установлены с помощью диспетчера пакетов NuGet в Visual Studio или установлены путем редактирования файла Android. csproj для включения `PackageReference` XML-элементов, перечисленных в сообщении об ошибке.

После разрешения недостающих пакетов перестроение проекта загружает недостающие пакеты, а проект компилируется с использованием зависимостей Андроидкс вместо поддержки зависимостей библиотек.

> [!NOTE]
> Если проект и зависимости проекта не ссылаются на библиотеки поддержки Android, процесс миграции не выполняет никаких действий и не выполняется.

## <a name="related-links"></a>Связанные ссылки

- [Обзор библиотеки поддержки Android](https://developer.android.com/topic/libraries/support-library/index) на Developer.Android.com
- [Обзор андроидкс](https://developer.android.com/jetpack/androidx) на Developer.Android.com
